setwd("~/Documents/GitHub/FAD_New_Start/SAVE point")
rm(list = ls())
library("CTT")
library("dplyr")
library("psych")
library("lavaan")
library("semPlot")
library("semTools")
datafadall <- read.csv("cleanfadall.csv")
datafadchina <- datafadall[which(datafadall$g==0),-1]
datafadforeign <- datafadall[which(datafadall$g==1),-1]
desdatachina <- datafadchina[,1:4] #descriptions of chinese datasets
apply(desdatachina, 2, psych::describe)
apply(desdatachina, 2, table)
desdataforeign <- datafadforeign[,1:4] #descriptions of foriegn datasets
apply(desdataforeign, 2, psych::describe)
apply(desdataforeign, 2, table)
fadnames <- c("FD1","FD5","FD9","FD13","FD17",
"SD2","SD6","SD10","SD14","SD18","SD22","SD24",
"UP3","UP7","UP11","UP15","UP19","UP20","UP25","UP27",
"FW4","FW8","FW12","FW16","FW21","FW23","FW26")
fadchinasolo <- datafadchina[,fadnames]
FDnames <- c("FD1","FD5","FD9","FD13","FD17")
SDnames <- c("SD2","SD6","SD10","SD14","SD18","SD22","SD24")
UPnames <- c("UP3","UP7","UP11","UP15","UP19","UP20","UP25","UP27")
FWnames <- c("FW4","FW8","FW12","FW16","FW21","FW23","FW26")
fadFDC <- datafadchina[,FDnames]
fadSDC <- datafadchina[,SDnames]
fadUPC <- datafadchina[,UPnames]
fadFWC <- datafadchina[,FWnames]
fadchinalist <- list(fadFDC,fadSDC,fadUPC,fadFWC)
fadFDF <- datafadforeign[,FDnames]
fadSDF <- datafadforeign[,SDnames]
fadUPF <- datafadforeign[,UPnames]
fadFWF <- datafadforeign[,FWnames]
fadforeignlist <- list(fadFDF,fadSDF,fadUPF,fadFWF)
fadforeignsolo <- datafadforeign[,fadnames]
fadsolo <- datafadall[,fadnames]
head(fadsolo)
g <- datafadall$g
dataforinvariance <- cbind(g,fadsolo)
head(dataforinvariance)
table(g)
dataforinvariance$g <- factor(dataforinvariance[,1],levels=c("0","1"))
table(dataforinvariance$g)
config <- cfa(model, dataforinvariance, group="g")
model <- 'FD =~ FD1 + FD5 + FD9 + FD13 + FD17;
SD =~ SD2 + SD6 + SD10 + SD14 + SD18 + SD22 + SD24;
UP =~ UP3 + UP7 + UP11 + UP15 + UP19 + UP20 + UP25 + UP27;
FW =~ FW4 + FW8 + FW12 + FW16 + FW21 + FW23 + FW26'
fadsolo <- datafadall[,fadnames]
head(fadsolo)
g <- datafadall$g
dataforinvariance <- cbind(g,fadsolo)
head(dataforinvariance)
table(g)
dataforinvariance$g <- factor(dataforinvariance[,1],levels=c("0","1"))
table(dataforinvariance$g)
config <- cfa(model, dataforinvariance, group="g")
weak <- cfa(model, dataforinvariance, group="g", group.equal="loadings") #factor weight
strong<- cfa(model, dataforinvariance, group="g", group.equal= c("loadings", "intercepts"))  #set the same weight and intercepts
strict<- cfa(model, dataforinvariance, group="g",
group.equal= c("loadings", "intercepts", "residuals"))   #residues
summary(config)
summary(weak)
summary(strong)
summary(strict)
anova(config, weak, strong, strict)
measurementInvariance(model=model, data=dataforinvariance, group="g",estimator="WLSM") #"ULS"
anova(config, weak, strong, strict)
measurementInvarianceCat(model,dataforinvariance)
> measurementInvarianceCat(model,dataforinvariance,"g")
measurementInvarianceCat(model,dataforinvariance,"g")
measurementInvarianceCat(model=model,data=dataforinvariance,group="g")
anova(config, weak, strong, strict)
0.842-0.821
0.821-0.731
0.731-0.694
0.078-0.065
0.083-0.078
anova(config, weak, strong, strict)
